<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800&family=Montserrat:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />   
<link rel="stylesheet" href="../css/style.css" />
<link rel="shortcut icon" href="../assets/images/logo-color.svg" type="image/x-icon">
    <title>My Brand</title>
  </head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <body>
    <div class="dashboard-container " >
        
        <div class="error-container" id="error-container">
            <span class="material-symbols-outlined" id="error-icon"> error </span>
            <p id="error-text" class="error-text"></p>
          </div>
          
          <div class=" success-container" id="success-container">
            <span class="material-symbols-outlined" id="error-icon"> check_circle </span>
            <p id="success-text" class="success-text"></p>
          </div>

    <aside class="dashboard-sidebar">
        <div class="dashboard-image-logo">
            <img src="../assets/images/logo.png" alt="logo"/>
        </div>

        <div class="dashboard-links-container">
            <a href="./dashboard.html" class="rounded-text grey-text category-tag dashboard-link" >
                <img src="../assets//images//dashboard-icons/dashboard.svg" alt="">
                <p>Dashboard</p>
            </a>
            <a href="./dashboard-articles.html"  class="rounded-text grey-text category-tag dashboard-link" id="active-dashboard-link">
                <img src="../assets//images//dashboard-icons/articles.svg" alt="">
                <p>Articles</p>
            </a>
            <a href="./dashboard-messages.html" class="rounded-text grey-text category-tag dashboard-link">
                <img src="../assets//images//dashboard-icons/messages.svg" alt="">
                <p>Messages</p>
            </a>
            <a href="./dashboard-users.html" class="rounded-text grey-text category-tag dashboard-link">
                <img src="../assets//images//dashboard-icons/users.svg" alt="">
                <p>Users</p>
            </a>
            <a href="./dashboard-projects.html" class="rounded-text grey-text category-tag dashboard-link">
                <img src="../assets//images//dashboard-icons/projects.svg" alt="">
                <p>Projects</p>
            </a>
            <a href="./dashboard-tesimonial.html" class="rounded-text grey-text category-tag dashboard-link">
                <img src="../assets//images//dashboard-icons/testimonial.svg" alt="">
                <p>Skills</p>
            </a>
        </div>
        <button
          class="rounded-text grey-text category-tag dashboard-link dashboard-logout"
          id="logout-button">
          <p>Logout</p>
          <img src="../assets//images//dashboard-icons/logout.svg" alt="" />
        </button>
    </aside>

    <div class="dashboard-content-container">

        <div class="dashboard-header">
            <div class="input-for">
              </div>
            <div class="dashboard-user-info">
                <img src="../assets/images/admin.png" alt="avatar" class="avatar">
                <div>
                    <p class="white-text small-text title">Rwirangira</p>
                    <p class="grey-text small-text">Admin</p>
                </div>
            </div>
        </div>
        <div class="dashboard-content">
        <div class="dashboard-tags-container">
            <div class="dashboard-tag">
                <img src="../assets/images/dashboard-icons/comment.svg" alt="">
                <div>
                    <p class="title white-text">Total Comments</p>
                    <p class="title grey-text big-text">20</p>
                </div>
            </div>
            <div class="dashboard-tag">
                <img src="../assets/images/dashboard-icons/eye.svg" alt="">
                <div>
                    <p class="title white-text">Total Views</p>
                    <p class="title grey-text big-text">20</p>
                </div>
            </div>

            <div class="dashboard-tag">
                <img src="../assets/images/dashboard-icons/articles.svg" alt="">
                <div>
                    <p class="title white-text">Total Articles</p>
                    <p class="title grey-text big-text" id="total-articles">20</p>
                </div>
            </div>
        </div>
        <div class="dashboard-data-container">
            <div class="dashboard-blog-container dashboard-all-blogs">
                <div class="dashboard-blog-container-upper ">
                    <div>
                        <p class="title white-text small-text"> Recent Articles</p>
                    <div>
                        <p class="small-text title">Category:</p>
                    <p class=" white-text rounded-text category-tag small-text">All</p>
                    </div>
                    </div>
                    <a href="./dashboard-add-blog.html" class=" white-text rounded-text category-tag small-text">+ New</a>
                </div>
                <div class="dashboard-blog-container-map">

                    <table class="dashboard-blog-table">
                        <thead>
                            <tr class=''>
                                <th class="small-text text-white">Poster</th>
                                <th class="small-text text-white">Title</th>
                                <th class="small-text text-white">Views</th>
                                <th class="small-text text-white ">Likes</th>
                                <th class="small-text text-white ">Comments</th>
                                <th class="small-text text-white ">Time Created</th>
                                <th class="small-text text-white "></th>
                                <th class="small-text text-white "></th>
                              </tr>
                        </thead>
                            
                        <tbody id="dashboard-blog-table-body">
                            <tr id="dashboard-blog-row">
                                <td>
                                    <img src="../assets/images/company-logo.png" alt="" class="dashboard-blog-poster">
                                </td>
    
                                <td>
                                    <p class="small-text blog-title">ChatGPT : A Developer's Best Friend or Worst Enemy?</p>
                                </td>
                                <td>
                                    <div class="like">
                                      <img src="../assets//images//dashboard-icons/eye.svg" alt="" >
                                    <p class="light-text smaller-text">12 views</p>  
                                    </div>
                                    
                                </td>
                                <td>
                                    <div class="like">
                                       <img src="../assets//images//dashboard-icons/heart.svg" alt="">
                                    <p class="light-text smaller-text">12 likes</p>  
                                    </div>
                                   
                                </td>
                                <td>
                                    <div class="like">
                                        <img src="../assets//images//dashboard-icons/comment.svg" alt="">
                                    <p class="light-text smaller-text">12 comments</p> 
                                    </div>
                                   
                                </td>
                                <td>
                                    <p class="small-text">04/February/2024</p>
                                </td>
                                <td>
                                    <p class="small-text rounded-text text-blue title category-tag">View</p>
                                </td>
                                <td>
                                    <p class="small-text rounded-text text-green title category-tag">Edit</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <img src="../assets/images/company-logo.png" alt="" class="dashboard-blog-poster">
                                </td>
    
                                <td>
                                    <p class="small-text blog-title">ChatGPT : A Developer's Best Friend or Worst Enemy?</p>
                                </td>
                                <td>
                                    <p class="small-text">Technology</p>
                                </td>
                                <td>
                                    <div class="like">
                                      <img src="../assets//images//dashboard-icons/eye.svg" alt="" >
                                    <p class="light-text smaller-text">12 views</p>  
                                    </div>
                                    
                                </td>
                                <td>
                                    <div class="like">
                                       <img src="../assets//images//dashboard-icons/heart.svg" alt="">
                                    <p class="light-text smaller-text">12 likes</p>  
                                    </div>
                                   
                                </td>
                                <td>
                                    <div class="like">
                                        <img src="../assets//images//dashboard-icons/comment.svg" alt="">
                                    <p class="light-text smaller-text">12 comments</p> 
                                    </div>
                                   
                                </td>
                                <td>
                                    <p class="small-text">04/February/2024</p>
                                </td>
                                <td>
                                    <p class="small-text rounded-text text-blue title category-tag">View</p>
                                </td>
                                <td>
                                    <p class="small-text rounded-text text-green title category-tag">Edit</p>
                                </td>
                            </tr>
                            
                        </tbody>
                    </table>
                </div>

            </div>
           
        </div>
    </div>
    </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          var articles = JSON.parse(localStorage.getItem('articles'));
          if (articles && articles.length > 0) {
            var cardsHTML = "";
            articles.forEach(function(article) {
              cardsHTML += `
                <div class="poster">
                  <img src="${article.poster}" id="picture">
                  <p id="title">${article.title}</p>
                  <div id="poster-text">
                    <p id="descript">${article.subtitle}</p>
                  </div>
                  <div class="icons">
                    <svg xmlns="http://www.w3.org/2000/svg" class="like" viewBox="0 0 512 512">
                      <path fill="#0d478c" d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/>
                    </svg>
                    <p class="item-like">${article.likes.length}</p>
                    <svg xmlns="http://www.w3.org/2000/svg" class="view" viewBox="0 0 576 512">
                      <path fill="#0d478c" d="M288 80c-65.2 0-118.8 29.6-159.9 67.7C89.6 183.5 63 226 49.4 256c13.6 30 40.2 72.5 78.6 108.3C169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256c-13.6-30-40.2-72.5-78.6-108.3C406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1c3.3 7.9 3.3 16.7 0 24.6c-14.9 35.7-46.2 87.7-93 131.1C433.5 443.2 368.8 480 288 480s-145.5-36.8-192.6-80.6C48.6 356 17.3 304 2.5 268.3c-3.3-7.9-3.3-16.7 0-24.6C17.3 208 48.6 156 95.4 112.6zM288 336c44.2 0 80-35.8 80-80s-35.8-80-80-80c-.7 0-1.3 0-2 0c1.3 5.1 2 10.5 2 16c0 35.3-28.7 64-64 64c-5.5 0-10.9-.7-16-2c0 .7 0 1.3 0 2c0 44.2 35.8 80 80 80zm0-208a128 128 0 1 1 0 256 128 128 0 1 1 0-256z"/>
                    </svg>
                    <p class="item-view">${article.views.length}</p>
                    <svg xmlns="http://www.w3.org/2000/svg" class="comment" viewBox="0 0 512 512">
                      <path fill="#0d478c" d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"/>
                    </svg>
                    <p class="item-comment">${article.comments.length}</p>
                  </div>
                </div>
              `;
            });
            document.getElementById('cards').innerHTML = cardsHTML;
          } else {
            console.log('No articles found in localStorage.');
          }
        });
        
      </script>
  
    <!-- <script src="../Js/dashboard.js"></script> -->
    <script>
        let allArticles = JSON.parse(localStorage.getItem('articles')) || [];
        let messageRow = document.getElementById('dashboard-blog-row');
        const totalArticles = document.getElementById('total-articles')
        totalArticles.innerText = allArticles.length
        console.log("All articles",allArticles)

        const populateBlogTable = ()=>{
            let tableBody = document.getElementById('dashboard-blog-table-body');
            tableBody.innerHTML='';

            allArticles.map((article,index)=>{
                let row = document.createElement('tr')
                row.classList.add('dashboard-blog-row')

                // poster
                let posterTD = document.createElement('td');
                let poster = document.createElement('img')
                poster.src=article.poster 
                poster.classList.add('dashboard-blog-poster')

                posterTD.appendChild(poster)

                // title
                let titleTD = document.createElement('td');
                let title = document.createElement('p')
                title.innerText=article.title 
                title.classList.add('small-text', 'blog-title')

                titleTD.appendChild(title)

                // category
                // likes
                let viewTD = document.createElement('td');
                let view = document.createElement('div')
                let viewIcon = document.createElement('img')
                let viewSize =document.createElement('p')
                viewIcon.src="../assets/images/dashboard-icons/eye.svg"
                viewSize.classList.add('smaller-text', 'light-text')
                viewSize.innerText=article.views.length + '-views' || '12 views'
                view.appendChild(viewIcon)
                view.appendChild(viewSize)
                view.classList.add('like')

                viewTD.appendChild(view)

                // likes
                let likeTD = document.createElement('td');
                let like = document.createElement('div')
                let likeIcon = document.createElement('img')
                let likeSize =document.createElement('p')
                likeIcon.src="../assets/images/dashboard-icons/heart.svg"
                likeSize.classList.add('smaller-text', 'light-text')
                likeSize.innerText=article.likes.length + '-likes' || '12 likes'

                like.appendChild(likeIcon)
                like.appendChild(likeSize)
                like.classList.add('like')

                likeTD.appendChild(like)

                // commentss
                let commentsTD = document.createElement('td');
                let comments = document.createElement('div')
                let commentsIcon = document.createElement('img')
                let commentsSize =document.createElement('p')
                commentsIcon.src="../assets/images/dashboard-icons/comment.svg"
                commentsSize.classList.add('smaller-text', 'light-text')
                commentsSize.innerText=`${article.comments.length}-comments` || '12 views'

                comments.appendChild(commentsIcon)
                comments.appendChild(commentsSize)
                comments.classList.add('like')

                commentsTD.appendChild(comments)

                
                // date
                let dateTD = document.createElement('td');
                let date = document.createElement('p')
                date.innerText=article.date 
                date.classList.add('small-text')

                dateTD.appendChild(date)

                // View Button
                let viewButtonTD =document.createElement('td')
                let viewButton = document.createElement('button');
                viewButton.textContent = 'View';
                viewButton.classList.add('small-text', 'rounded-text', 'text-blue', 'title', 'category-tag');
                // Add click event listener to "View" link
                viewButton.addEventListener('click', () => window.location.href=`./dashboard-single-blog.html?index=${index}`);
                viewButtonTD.appendChild(viewButton);

                // edit
                
        let editButtonTD = document.createElement('td');
        editButtonTD.innerHTML = `<a  class="text-green"> <button class="small-text rounded-text text-green title category-tag">Edit</button></a>`;

                // append all
                row.appendChild(posterTD,titleTD)
                row.appendChild(titleTD)
                row.appendChild(viewTD)
                row.appendChild(likeTD)
                row.appendChild(commentsTD)
                row.appendChild(dateTD)
                row.appendChild(viewButtonTD)
                row.appendChild(editButtonTD)
                tableBody.appendChild(row)

            })
        }
            populateBlogTable()
    </script>

        <!-- protect dashboard from unauthorised access -->
        <script>
          //  const logoutButton = document.getElementById("logout-button");
          //  const loggedUser = JSON.parse(localStorage.getItem("loggedUser"));
          //  console.log("loggedUser", loggedUser);
      //
          //  if (!loggedUser || loggedUser.role != "admin") {
          //    window.location.href = "../errorPage.html";
          //  } else {
          //    
          //  }
      //
          //  logoutButton.addEventListener("click", () => {
          //    localStorage.removeItem("loggedUser")
          //    successContainer.style.display = "flex",
          //    successElement.innerHTML = "Logged out successfully"
          //    timeDelay(successContainer, successElement)
          //    window.location.href = "../index.html";
          //  });
          </script>
          <script src="../Js/theme.js"></script>

  </body>
</html>
